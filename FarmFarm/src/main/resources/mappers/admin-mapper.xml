<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminMapper">


 <resultMap type="Member" id="member_rm">
        <!-- DB에서 PK에 해당하는 필드, 컬럼을 작성하는 태그 -->
     <id property = "memberNo" column="MEMBER_NO"/>
     <!-- 나머지 일반 컬럼 -->
      <result property="memberId" column="MEMBER_ID" />
      <result property="memberPw" column="MEMBER_PW" />
      <result property="memberName" column="MEMBER_NAME" />
      <result property="memberNickname" column="MEMBER_NICKNAME" />
      <result property="memberTel" column="MEMBER_TEL" />
      <result property="signUpDate" column="SIGNUP_DATE" />
      <result property="memberDelFl" column="MEMBER_DEL_FL" />
      <result property="memberBirth" column="MEMBER_BIRTH" />
      <result property="authority" column="AUTHORITY" />
      <result property="profileImg" column="PROFILE_IMG" />
      <result property="mypageImg" column="MYPAGE_IMG" />
      <result property="memberAddress" column="MEMBER_ADDRESS" />
      <result property="farmImg" column="FARM_IMG" />
      <result property="postCount" column="POST_COUNT" />
      <result property="boardCount" column="BOARD_COUNT" />
      <result property="commentCount" column="COMMENT_COUNT" />
      <result property="orderCount" column="ORDER_COUNT" />
   
      
  </resultMap>

 <resultMap type="MemberAddress" id="memberAddress_rm">
        <!-- DB에서 PK에 해당하는 필드, 컬럼을 작성하는 태그 -->
     <id property = "addressNo" column="ADDRESS_NO"/>
     <!-- 나머지 일반 컬럼 -->
      <result property="memberAddress" column="MEMBER_ADDRESS" />
      <result property="defaultFl" column="DEFAULT_FL" />
      <result property="memberNo" column="MEMBER_NO" />
  </resultMap>
  
  
  



	<!-- 관리자인지 확인 -->
	<select id="checkAdmin" resultType="_int">
		SELECT COUNT(*)
		FROM "MEMBER" 
		WHERE AUTHORITY = 2
	</select>


	<!-- 대시보드 -->
	<!-- 신규 주문 통계 -->
	<select id="newOrderStat" resultType="_int">
		SELECT COUNT(*)
		FROM "ORDER" 
		WHERE ORDER_STATUS = 0
	</select>

	<!-- 미처리 신고 -->
	<select id="askReportStat" resultType="_int">
		SELECT COUNT(*)
		FROM REPORT 
		WHERE PROCESS_DATE IS NULL
	</select>
	
	<!-- 판매자 인증 접수 -->
	<select id="authSellerStat" resultType="_int">
		SELECT COUNT(*)
		FROM "MEMBER" 
		WHERE AUTHORITY = 3
	</select>

	
	<!-- 전체 회원 정보 조회 -->
	<select id="selectMemberAll" resultMap="member_rm">
		SELECT *
		FROM MEMBER
		LEFT JOIN ADDRESS USING(MEMBER_NO)
		LEFT JOIN SELLER USING(MEMBER_NO)
		
		<if test='memberNo != null and memberNo !=""'>
			WHERE MEMBER_NO = #{memberNo}
		</if>
	</select>




</mapper>